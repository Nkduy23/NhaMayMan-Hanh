<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trang chủ</title>
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="assets/favicon/android-icon-192x192.png"
    />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/home.css" />
    <link rel="stylesheet" href="assets/css/box-product.css" />
    <link rel="stylesheet" href="assets/css/cart.css">
  </head>
  <body>
    <header></header>

    <!-- Nội dung trang ở đây -->
    <main class="home">
      <section class="hero">
        <div class="hero-content">
          <h1>Chào mừng đến với cửa hàng</h1>
          <p>Chọn sản phẩm bạn yêu thích và thêm vào giỏ hàng</p>
          <a href="#" class="btn">Xem sản phẩm</a>
        </div>
      </section>

      <section class="product-list">
        <h2>Sản phẩm nổi bật</h2>
      </section>
    </main>

    <footer></footer>
  </body>

  <script src="assets/js/layout.js"></script>
  <script type="module">
    import { products } from "./assets/data/products.js";

    const list = document.querySelector(".product-list");

    // === CHỈ THÊM NÚT + DÙNG CSS BẠN ĐÃ CÓ ===
    list.innerHTML = products
      .map(
        (p) => `
    <div class="product">
      <img src="${p.img}" alt="${p.name}">
      <h3>${p.name}</h3>
      <p>${p.price.toLocaleString()}₫</p>
      <button class="add-to-cart-btn" data-id="${p.id}">
        Thêm vào giỏ hàng
      </button>
    </div>
  `
      )
      .join("");

    // === CHỨC NĂNG NÚT: Lưu localStorage + hiệu ứng "Done" ===
    document.querySelectorAll(".add-to-cart-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = parseInt(btn.getAttribute("data-id"));
        const product = products.find(p => p.id === id);

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existing = cart.find(item => item.id === id);

        if (existing) {
          existing.qty += 1;
        } else {
          cart.push({ id, qty: 1 });
        }

        localStorage.setItem("cart", JSON.stringify(cart));

        // Hiệu ứng "Done"
        btn.classList.add("added");
        btn.innerHTML = "Đã thêm";

        setTimeout(() => {
          btn.classList.remove("added");
          btn.innerHTML = "Thêm vào giỏ hàng";
        }, 1500);
      });
    });
  </script>
</html>