<!DOCTYPE html>
<html lang="vi">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Chi tiết sản phẩm - Nhà May Mắn</title>
      <link rel="stylesheet" href="assets/css/style.css" />
      <link rel="stylesheet" href="assets/css/header.css" />
      <link rel="stylesheet" href="assets/css/footer.css" />
      <style>
         * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
         }

         body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
               Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #ffffff;
            color: #2c3e50;
         }

         .container {
            max-width: 1400px;
            margin: 60px auto;
            padding: 0 40px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
            align-items: start;
         }

         /* Image Section */
         .product-image {
            position: sticky;
            top: 20px;
         }

         .product-image img {
            width: 100%;
            height: auto;
            border-radius: 16px;
            display: block;
         }

         /* Product Info Section */
         .product-info {
            padding: 20px 0;
         }

         .title {
            font-size: 36px;
            font-weight: 600;
            line-height: 1.3;
            color: #1a1a1a;
            margin-bottom: 16px;
            letter-spacing: -0.5px;
         }

         .price {
            font-size: 42px;
            font-weight: 700;
            color: #1a1a1a;
            margin: 24px 0;
            letter-spacing: -1px;
         }

         .price del {
            font-size: 28px;
            color: #95a5a6;
            font-weight: 400;
            margin-left: 12px;
         }

         .discount-tag {
            display: inline-block;
            background: #ff3b30;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            margin-left: 12px;
            vertical-align: middle;
         }

         hr {
            border: none;
            height: 1px;
            background: #e8e8e8;
            margin: 32px 0;
         }

         .description {
            font-size: 16px;
            line-height: 1.7;
            color: #555;
            margin: 24px 0;
         }

         /* Info Grid */
         .info-grid {
            display: grid;
            gap: 16px;
            margin: 32px 0;
         }

         .info-item {
            display: flex;
            font-size: 15px;
            color: #666;
         }

         .info-item span:first-child {
            min-width: 120px;
            color: #999;
         }

         .info-item strong {
            color: #1a1a1a;
            font-weight: 500;
         }

         .hotline {
            color: #ff3b30;
            font-weight: 600;
            font-size: 17px;
         }

         .vietnam-note {
            background: #f7f8fa;
            padding: 16px 20px;
            border-radius: 8px;
            font-size: 14px;
            color: #666;
            margin: 24px 0;
            border-left: 3px solid #ff3b30;
         }

         /* Size Selection */
         .size-select {
            margin: 40px 0 32px 0;
         }

         .size-select label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .size-select select {
            width: 100%;
            padding: 16px 20px;
            font-size: 15px;
            border: 1.5px solid #ddd;
            border-radius: 8px;
            background: white;
            color: #1a1a1a;
            cursor: pointer;
            transition: all 0.2s;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L6 6L11 1' stroke='%23666' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 20px center;
            padding-right: 50px;
         }

         .size-select select:hover {
            border-color: #1a1a1a;
         }

         .size-select select:focus {
            outline: none;
            border-color: #1a1a1a;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.05);
         }

         /* Quantity & Add to Cart */
         .purchase-section {
            display: flex;
            gap: 16px;
            margin: 40px 0;
            align-items: center;
         }

         .quantity-wrapper {
            display: flex;
            align-items: center;
            border: 1.5px solid #ddd;
            border-radius: 8px;
            background: white;
            height: 56px;
         }

         .quantity-wrapper button {
            width: 50px;
            height: 100%;
            background: transparent;
            border: none;
            font-size: 20px;
            color: #1a1a1a;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
         }

         .quantity-wrapper button:hover {
            background: #f7f8fa;
         }

         .quantity-wrapper button:active {
            background: #eee;
         }

         .quantity-wrapper input {
            width: 60px;
            height: 100%;
            text-align: center;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #1a1a1a;
            background: transparent;
         }

         .quantity-wrapper input:focus {
            outline: none;
         }

         .add-to-cart {
            flex: 1;
            height: 56px;
            background: #1a1a1a;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
         }

         .add-to-cart:hover {
            background: #000;
            transform: translateY(-1px);
         }

         .add-to-cart:active {
            transform: translateY(0);
         }

         /* Not Found */
         .not-found {
            grid-column: 1 / -1;
            text-align: center;
            padding: 100px 20px;
         }

         .not-found h2 {
            font-size: 32px;
            color: #1a1a1a;
            margin-bottom: 12px;
            font-weight: 600;
         }

         .not-found p {
            font-size: 16px;
            color: #999;
         }

         /* Product Details Section */
         .product-details {
            grid-column: 1 / -1;
            margin-top: 80px;
            padding-top: 60px;
            border-top: 1px solid #e8e8e8;
         }

         .details-tabs {
            display: flex;
            gap: 40px;
            border-bottom: 1px solid #e8e8e8;
            margin-bottom: 40px;
         }

         .tab-button {
            padding: 16px 0;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #999;
            cursor: pointer;
            position: relative;
            transition: color 0.2s;
         }

         .tab-button.active {
            color: #1a1a1a;
         }

         .tab-button.active::after {
            content: "";
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: #1a1a1a;
         }

         .tab-content {
            display: none;
            animation: fadeIn 0.3s;
         }

         .tab-content.active {
            display: block;
         }

         @keyframes fadeIn {
            from {
               opacity: 0;
               transform: translateY(10px);
            }
            to {
               opacity: 1;
               transform: translateY(0);
            }
         }

         .details-content {
            max-width: 900px;
         }

         .details-content h3 {
            font-size: 20px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 16px;
         }

         .details-content p {
            font-size: 15px;
            line-height: 1.8;
            color: #666;
            margin-bottom: 16px;
         }

         .details-content ul {
            list-style: none;
            padding-left: 0;
         }

         .details-content ul li {
            font-size: 15px;
            line-height: 1.8;
            color: #666;
            padding-left: 24px;
            position: relative;
            margin-bottom: 12px;
         }

         .details-content ul li::before {
            content: "•";
            position: absolute;
            left: 8px;
            color: #1a1a1a;
            font-weight: bold;
         }

         .specs-table {
            width: 100%;
            border-collapse: collapse;
            margin: 24px 0;
         }

         .specs-table tr {
            border-bottom: 1px solid #e8e8e8;
         }

         .specs-table td {
            padding: 16px 0;
            font-size: 15px;
         }

         .specs-table td:first-child {
            color: #999;
            width: 200px;
         }

         .specs-table td:last-child {
            color: #1a1a1a;
            font-weight: 500;
         }

         /* Responsive */
         @media (max-width: 968px) {
            .container {
               grid-template-columns: 1fr;
               gap: 40px;
               margin: 40px auto;
               padding: 0 20px;
            }

            .product-image {
               position: relative;
               top: 0;
            }

            .title {
               font-size: 28px;
            }

            .price {
               font-size: 32px;
            }

            .purchase-section {
               flex-direction: column;
            }

            .quantity-wrapper {
               width: 100%;
               justify-content: center;
            }

            .add-to-cart {
               width: 100%;
            }

            .product-details {
               margin-top: 60px;
               padding-top: 40px;
            }

            .details-tabs {
               gap: 24px;
               overflow-x: auto;
            }

            .tab-button {
               font-size: 14px;
               white-space: nowrap;
            }

            .specs-table td:first-child {
               width: 140px;
            }
         }
      </style>
   </head>
   <body>
      <header></header>
      <main>
         <div class="container">
            <div class="product-image">
               <img id="product-img" src="" alt="" />
            </div>
            <div class="product-info">
               <h1 class="title" id="product-name">Đang tải...</h1>

               <div class="price" id="product-price">...</div>

               <hr />

               <div class="description" id="product-desc"></div>

               <div class="info-grid">
                  <div class="info-item" id="material-info"></div>
                  <div class="info-item">
                     <span>Mã sản phẩm</span>
                     <strong id="product-code">...</strong>
                  </div>
                  <div class="info-item">
                     <span>Liên hệ</span>
                     <span class="hotline" id="hotline">...</span>
                  </div>
               </div>

               <div class="vietnam-note" id="vietnam-info"></div>

               <div class="size-select">
                  <label>Kích thước</label>
                  <select id="size-select">
                     <option>Chọn kích thước</option>
                     <option>Nhỏ (S)</option>
                     <option>Trung bình (M)</option>
                     <option>Lớn (L)</option>
                  </select>
               </div>

               <div class="purchase-section">
                  <div class="quantity-wrapper">
                     <button type="button">−</button>
                     <input type="text" value="1" readonly />
                     <button type="button">+</button>
                  </div>
                  <button class="add-to-cart">Thêm vào giỏ hàng</button>
               </div>
            </div>

            <!-- Product Details Section -->
            <div class="product-details">
               <div class="details-tabs">
                  <button class="tab-button active" data-tab="description">
                     Mô tả
                  </button>
                  <button class="tab-button" data-tab="specifications">
                     Thông số
                  </button>
                  <button class="tab-button" data-tab="care">
                     Hướng dẫn bảo quản
                  </button>
               </div>

               <div id="description" class="tab-content active">
                  <div class="details-content">
                     <h3>Về sản phẩm</h3>
                     <p id="detail-description"></p>
                     <p id="detail-story"></p>
                  </div>
               </div>

               <div id="specifications" class="tab-content">
                  <div class="details-content">
                     <h3>Thông số kỹ thuật</h3>
                     <table class="specs-table">
                        <tr>
                           <td>Chất liệu</td>
                           <td id="spec-material"></td>
                        </tr>
                        <tr>
                           <td>Mã sản phẩm</td>
                           <td id="spec-code"></td>
                        </tr>
                        <tr>
                           <td>Kích thước có sẵn</td>
                           <td>Nhỏ (S), Trung bình (M), Lớn (L)</td>
                        </tr>
                        <tr>
                           <td>Xuất xứ</td>
                           <td>Việt Nam</td>
                        </tr>
                        <tr>
                           <td>Sản xuất</td>
                           <td>Thủ công</td>
                        </tr>
                     </table>
                  </div>
               </div>

               <div id="care" class="tab-content">
                  <div class="details-content">
                     <h3>Hướng dẫn bảo quản</h3>
                     <ul>
                        <li>Giặt tay nhẹ nhàng với nước lạnh hoặc ấm</li>
                        <li>
                           Sử dụng xà phòng trung tính, tránh chất tẩy mạnh
                        </li>
                        <li>
                           Không vắt mạnh, để khô tự nhiên ở nơi thoáng mát
                        </li>
                        <li>Là ở nhiệt độ thấp nếu cần thiết</li>
                        <li>
                           Bảo quản ở nơi khô ráo, tránh ánh nắng trực tiếp
                        </li>
                        <li>Tránh tiếp xúc với hóa chất mạnh hoặc nước hoa</li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </main>
      <footer></footer>

      <script src="assets/js/layout.js"></script>
      <script type="module">
         import { products } from "../assets/data/products-home/products.js";

         function formatUSD(price) {
            return price.toFixed(2);
         }

         const urlParams = new URLSearchParams(window.location.search);
         const id = urlParams.get("id");
         const category = urlParams.get("category") || "sewing";

         const categoryData = products[category];
         const product = categoryData
            ? categoryData.find((p) => p.id === id)
            : null;

         if (!product) {
            document.querySelector(".container").innerHTML = `
            <div class="not-found">
               <h2>Không tìm thấy sản phẩm</h2>
               <p>Sản phẩm bạn tìm kiếm không tồn tại</p>
            </div>
         `;
         } else {
            document.getElementById(
               "product-img"
            ).src = `../assets/img/products-home/${product.img}`;
            document.getElementById("product-img").alt = product.product_name;
            document.getElementById("product-name").textContent =
               product.product_name;

            const oldPrice = product.old_price
               ? formatUSD(product.old_price)
               : null;

            let discountHTML = "";
            if (oldPrice && product.price_range) {
               const currentPrice = parseFloat(
                  product.price_range.replace(/[^0-9.]/g, "")
               );
               const oldPriceNum = parseFloat(oldPrice);
               if (oldPriceNum > currentPrice) {
                  const discount = Math.round(
                     ((oldPriceNum - currentPrice) / oldPriceNum) * 100
                  );
                  discountHTML = `<span class="discount-tag">${discount}% OFF</span>`;
               }
            }

            document.getElementById("product-price").innerHTML = `
               ${product.price_range} ${
               oldPrice ? `<del>${oldPrice}$</del>` : ""
            } ${discountHTML}
            `;

            document.getElementById("product-desc").textContent =
               product.description;

            if (category === "canvas") {
               document.getElementById("material-info").innerHTML = `
                  <span>Tác giả</span>
                  <strong>${product.author || "Không rõ"}</strong>
               `;
            } else if (category === "cakes") {
               document.getElementById("material-info").innerHTML = `
                  <span>Loại bánh</span>
                  <strong>${product.product_name}</strong>
               `;
            } else {
               document.getElementById("material-info").innerHTML = `
                  <span>Chất liệu</span>
                  <strong>${product.material || "Vải thổ cẩm"}</strong>
               `;
            }

            document.getElementById("product-code").textContent =
               product.product_code || "TC01TB";
            document.getElementById("hotline").textContent =
               product.hotline || "0909 06 25 28";
            document.getElementById("vietnam-info").textContent =
               product.vietnam_contact_info ||
               "Liên hệ hotline để biết giá tại Việt Nam.";
            document.title = `${product.product_name} - Nhà May Mắn`;
         }

         document
            .querySelectorAll(".quantity-wrapper button")
            .forEach((btn) => {
               btn.addEventListener("click", () => {
                  const input = btn.parentElement.querySelector("input");
                  let val = parseInt(input.value) || 1;
                  if (btn.textContent === "+") val++;
                  if (btn.textContent === "−" && val > 1) val--;
                  input.value = val;
               });
            });
      </script>
   </body>
</html>
